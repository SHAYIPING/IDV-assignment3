<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>D – Assignment 3</title>
<link rel="stylesheet" href="styles.css"/>
<style>
.chart-slab{ background:#fff; border:1px solid var(--line); border-radius:8px; box-shadow:0 2px 14px rgba(0,0,0,.07); padding:0; overflow:hidden; display:flex; flex-direction:column; }
.chart-frame{ width:100%; height:560px; border:0; display:block; background:#fff; overflow:hidden; }
.detail-wrap{ align-items:start; }
.left-col,.right-col{ display:flex; flex-direction:column; }
.notes{ flex-grow:1; display:flex; flex-direction:column; justify-content:space-between; height:100%; }

.figure-grid{ display:grid; grid-template-columns:1fr 1fr; gap:18px; margin-top:18px; }
.figitem .img{ width:100%; background:#fff; border:1px solid var(--line); border-radius:6px; overflow:hidden; box-shadow:0 1px 8px rgba(0,0,0,.05); }
.figitem .img img{ width:100%; height:auto; display:block; }
.figitem .caption{ font-size:16px; color:#555; line-height:1.55; margin-top:8px; }
@media (max-width:800px){ .figure-grid{ grid-template-columns:1fr; } }
</style>
</head>
<body>

<div class="detail-wrap">
  <section class="left-col">
    <div class="detail-title"><h2>D</h2></div>

    <div class="chart-slab">
      <iframe class="chart-frame" id="chartD" src="charts/D.html" title="Chart D" scrolling="no"></iframe>
    </div>

    <div class="figure-grid">
      <div class="figitem">
        <div class="img"><img src="figs/D-info.jpg" alt="说明图 D"></div>
        <div class="caption"><strong>A：</strong>Give the coordinates of the points</div>
      </div>
      <div class="figitem">
        <div class="img"><img src="figs/D1-info.jpg" alt="说明图 D1"></div>
        <div class="caption"><strong>B：</strong>Wrong curve position</div>
      </div>
    </div>
  </section>

  <aside class="right-col">
  <div class="notes">
    <section class="notes">
      <h3>Notes / Code-based Chart (D3.js)</h3>

      <h4>1) Create the Drawing Canvas</h4>
      <p>
        Create an <code>&lt;svg&gt;</code> element as the drawing board (810×529 px).
        All shapes and lines are drawn inside it.
        Add margins so the chart doesn’t touch the edges, then define the inner width and height for the drawing area.
      </p>

      <h4>2) Create x and y Scales</h4>
      <p>
        Use <code>d3.scaleLinear()</code> to map data values to pixel positions.<br/>
        x-axis: from –2 → 5 (left → right)<br/>
        y-axis: from 0 → 0.35 (bottom → top)
      </p>

      <h4>3) Convert Pixel Anchor Points to Data</h4>
      <p>
        The yellow and green pixel coordinates are converted to real data values using the inverse of the scales.
      </p>

      <h4>4) Draw Background Grid and Smooth Curves</h4>
      <p>
        Draw light-gray grid lines with <code>d3.axisBottom()</code> and <code>d3.axisLeft()</code>.
        Hide the main axis lines, keeping only tick numbers.
        Use <code>d3.line().curve(d3.curveBasis)</code> to connect data points smoothly.
        There are two curves: yellow (<code>.curve0</code>) and green (<code>.curve1</code>).
      </p>

      <h4>5) Add Shaded Areas</h4>
      <p>
        Use <code>d3.area()</code> to create shaded areas below the curves.
        Apply <code>clipPath</code> to keep only the right half of the yellow curve and the left half of the green curve.
      </p>

      <h4>6) Draw Dashed Lines</h4>
      <p>
        Split the x-axis dashed line into two parts, leaving a blank gap in the center.
        Vertical dashed lines start at the x-axis and extend upward to the curves.
      </p>

      <h4>7) Add Animation</h4>
      <p>
        Curves are drawn gradually using the <code>stroke-dashoffset</code> trick.
        Dashed lines fade in slightly later.
        Shaded areas fade in afterward with opacity changing from 0 → 0.45.
      </p>

      <h4>8) Add Hover Interaction</h4>
      <p>
        Invisible “hit lines” are used to detect the mouse.
        When hovering: find the nearest data point → show a small circle → display tooltip with (x, y) values.
      </p>
    </section>

    <div style="height:24px;"></div>
  </div>
</aside>

</div>

<script>
(function(){
  const frame = document.getElementById('chartD');
  function resizeByRead(){
    try{
      const doc = frame.contentDocument || frame.contentWindow.document;
      const h = Math.max(doc.body.scrollHeight, doc.documentElement.scrollHeight, doc.body.offsetHeight, doc.documentElement.offsetHeight);
      if (h && Math.abs(frame.clientHeight - h) > 5) frame.style.height = h + 'px';
    }catch(e){}
  }
  frame.addEventListener('load', resizeByRead);
  window.addEventListener('message', (e)=>{
    if (!e.data || e.data.__chartHeight == null) return;
    const H = Math.max(320, Math.min(1200, e.data.__chartHeight));
    frame.style.height = H + 'px';
  });
})();
</script>
</body>
</html>
